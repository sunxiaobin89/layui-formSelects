"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}(function(e,t,n){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else if(t.layui&&e.define){e.define(["jquery"],function(e){e("formSelects",n())})}else{t.formSelects=n()}})(typeof layui=="undefined"?null:layui,window,function(){var t="4.0.0.0817",v="xm-select",m="xm-select-parent",y="xm-select-input",g="xm-select--suffix",w="xm-select-this",x="xm-select-label",k="xm-select-search",b="xm-select-search-type",C="xm-select-show-count",S="xm-select-create",c="xm-select-create-long",T="xm-select-max",L="xm-select-skin",A="xm-select-direction",j="xm-select-height",E="xm-dis-disabled",N="xm-select-dis",p="xm-select-temp",H="xm-select-radio",F="xm-select-linkage",D="xm-select-dl",h="xm-select-hide",_="xm-hide-input",O="xm-select-sj",e="xm-icon-close",I="xm-select-title",P="xm-form-select",f="xm-form-selected",U="xm-select-none",V="xm-select-empty",M="xm-input",J="xm-dl-input",W="xm-select-tips",l="xm-iconfont",B="XM_PID_VALUE",q="xm-cz",o="xm-cz-group",n="请选择",z={},R={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},X={type:"get",header:{},first:true,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function e(t,n,i){i([])},folderChoose:true,lazy:true}},i=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function e(t,n){n.selectAll(t,true,true)}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function e(t,n){n.removeAll(t,true,true)}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function e(t,n){n.reverse(t,true,true)}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function e(t,n){n.skin(t)}}],Q=window.$||window.layui&&window.layui.jquery,s=Q(window),Y={},a={},r={},$=function e(t){var o=this;this.config={name:null,max:null,maxTips:function e(t,n,i,a){var r=Q('[xid="'+o.config.name+'"]').prev().find("."+v);if(r.parents(".layui-form-item[pane]").length){r=r.parents(".layui-form-item[pane]")}r.attr("style","border-color: red !important");setTimeout(function(){r.removeAttr("style")},300)},init:null,on:null,opened:null,closed:null,filter:function e(t,n,i,a){return i.name.indexOf(n)==-1},clearid:-1,direction:"auto",height:null,isEmpty:false,btns:[i[0],i[1],i[2]],searchType:0,create:function e(t,n){return Date.now()},template:function e(t,n,i,a){return t},showCount:0,isCreate:false,placeholder:n,clearInput:false};this.select=null;this.values=[];Q.extend(this.config,t,{searchUrl:t.isSearch?t.searchUrl:null,placeholder:t.optionsFirst?t.optionsFirst.value?n:t.optionsFirst.innerHTML||n:n,btns:t.radio?[i[1]]:[i[0],i[1],i[2]]},r[t.name]||a);if(isNaN(this.config.showCount)||this.config.showCount<=0){this.config.showCount=19921012}};var d=function e(){this.appender();this.on();this.onreset()};d.prototype.appender=function(){if(!Array.prototype.map){Array.prototype.map=function(e,t){var n,i,a,r=Object(this),o=r.length>>>0;if(t){n=t}i=new Array(o);a=0;while(a<o){var l,s;if(a in r){l=r[a];s=e.call(n,l,a,r);i[a]=s}a++}return i}}if(!Array.prototype.forEach){Array.prototype.forEach=function e(t,n){var i,a;if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var o=r.length>>>0;if(typeof t!=="function"){throw new TypeError(t+" is not a function")}if(arguments.length>1){i=n}a=0;while(a<o){var l;if(a in r){l=r[a];t.call(i,l,a,r)}a++}}}if(!Array.prototype.filter){Array.prototype.filter=function(e){if(this===void 0||this===null){throw new TypeError}var t=Object(this);var n=t.length>>>0;if(typeof e!=="function"){throw new TypeError}var i=[];var a=arguments[1];for(var r=0;r<n;r++){if(r in t){var o=t[r];if(e.call(a,o,r,t)){i.push(o)}}}return i}}};d.prototype.init=function(e){var h=this;Q(e?e:"select["+v+"]").each(function(e,t){var n=Q(t),i=n.attr(v),a=n.next(".layui-form-select"),r=n.next("."+m),o={name:i,disabled:t.disabled,max:n.attr(T)-0,isSearch:n.attr(k)!=undefined,searchUrl:n.attr(k),isCreate:n.attr(S)!=undefined,radio:n.attr(H)!=undefined,skin:n.attr(L),direction:n.attr(A),optionsFirst:t.options[0],height:n.attr(j),formname:n.attr("name")||n.attr("_name"),layverify:n.attr("lay-verify")||n.attr("_lay-verify"),layverType:n.attr("lay-verType"),searchType:n.attr(b)=="dl"?1:0,showCount:n.attr(C)-0},l=n.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,value:e.value}}),s=new $(o);s.values=l;if(s.config.init){s.values=s.config.init.map(function(e){if((typeof e==="undefined"?"undefined":_typeof(e))=="object"){return e}return{name:n.find('option[value="'+e+'"]').text(),value:e}}).filter(function(e){return e.name});s.config.init=s.values.concat([])}else{s.config.init=l.concat([])}!s.values&&(s.values=[]);z[i]=s;a[0]&&a.remove();r[0]&&r.remove();var c=h.renderSelect(i,s.config.placeholder,t);var d=!s.config.height||s.config.height=="auto"?"":'xm-hg style="height: 34px;"';var f=['<div class="'+x+'">','<input type="text" fsw class="'+M+" "+y+'" '+(s.config.isSearch?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"];var u=Q('<div class="'+P+'" '+L+'="'+s.config.skin+'">\n\t\t\t\t\t<input class="'+_+'" value="" name="'+s.config.formname+'" lay-verify="'+s.config.layverify+'" lay-verType="'+s.config.layverType+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+I+" "+(s.config.disabled?N:"")+'">\n\t\t\t\t\t\t<div class="'+M+" "+v+'" '+d+">\n\t\t\t\t\t\t\t"+f.join("")+'\n\t\t\t\t\t\t\t<i class="'+O+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+g+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+s.config.placeholder+'" readonly="readonly" unselectable="on" class="'+M+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+i+'" class="'+D+" "+(s.config.radio?H:"")+'">'+c+"</dl>\n\t\t\t\t</div>");var p=Q('<div class="'+m+'" FS_ID="'+i+'"></div>');p.append(u);n.after(p);n.attr("lay-ignore","");n.removeAttr("name")&&n.attr("_name",s.config.formname);n.removeAttr("lay-verify")&&n.attr("_lay-verify",s.config.layverify);if(s.config.isSearch){Y[i]=Q.extend({},X,{searchUrl:s.config.searchUrl},Y[i]);Q(document).on("input","div."+m+'[FS_ID="'+i+'"] .'+y,function(e){h.search(i,e,s.config.searchUrl)});if(s.config.searchUrl){h.triggerSearch(u,true)}}else{u.find("dl dd."+J).css("display","none")}})};d.prototype.search=function(a,e,t,n){var r=this;var i=void 0;if(n){i=n}else{i=e.target;var o=e.keyCode;if(o===9||o===13||o===37||o===38||o===39||o===40){return false}}var l=Q.trim(i.value);this.changePlaceHolder(Q(i));var s=Y[a]?Y[a]:X;t=s.searchUrl||t;var c=z[a],d=c.config.isCreate,f=Q('dl[xid="'+a+'"]').parents("."+P);if(t){if(s.searchVal){l=s.searchVal;s.searchVal=""}if(!s.beforeSearch||s.beforeSearch&&s.beforeSearch instanceof Function&&s.beforeSearch(a,t,l)){var u=s.delay;if(s.first){s.first=false;u=10}clearTimeout(c.clearid);c.clearid=setTimeout(function(){f.find("dl > *:not(."+W+")").remove();f.find("dd."+U).addClass(V).text("请求中");r.ajax(a,t,l,false,null,true)},u)}}else{f.find("dl ."+h).removeClass(h);f.find("dl dd:not(."+W+")").each(function(e,t){var n=Q(t);var i=R.filter[a]||z[a].config.filter;if(i&&i(a,l,r.getItem(a,n),n.hasClass(E))==true){n.addClass(h)}});f.find("dl dt").each(function(e,t){if(!Q(t).nextUntil("dt",":not(."+h+")").length){Q(t).addClass(h)}});this.create(a,d,l);var p=f.find("dl dd:not(."+W+"):not(."+h+")");if(!p.length){f.find("dd."+U).addClass(V).text("无匹配项")}else{f.find("dd."+U).removeClass(V)}}};d.prototype.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"};d.prototype.triggerSearch=function(e,i){var a=this;(e?[e]:Q("."+P).toArray()).forEach(function(e,t){e=Q(e);var n=e.find("dl").attr("xid");if(n&&z[n]&&z[n].config.isEmpty||i){a.search(n,null,null,z[n].config.searchType==0?e.find("."+x+" ."+y):e.find("dl ."+J+" ."+y))}})};d.prototype.clearInput=function(e){var t=Q("."+m+'[fs_id="'+e+'"]');var n=z[e].config.searchType==0?t.find("."+x+" ."+y):t.find("dl ."+J+" ."+y);n.val("")};d.prototype.ajax=function(i,a,r,o,l,s){var c=this;var d=Q("."+m+' dl[xid="'+i+'"]').parents("."+P);if(!d[0]||!a){return}var f=Y[i]?Y[i]:X;var e=Q.extend(true,{},f.data);e[f.searchName]=r;Q.ajax({type:f.type,headers:f.header,url:a,data:f.dataType=="json"?JSON.stringify(e):e,success:function e(t){if(typeof t=="string"){t=JSON.parse(t)}f.beforeSuccess&&f.beforeSuccess instanceof Function&&(t=f.beforeSuccess(i,a,r,t));if(c.isArray(t)){var n={};n[f.response.statusName]=f.response.statusCode;n[f.response.msgName]="";n[f.response.dataName]=t;t=n}if(t[f.response.statusName]!=f.response.statusCode){d.find("dd."+U).addClass(V).text(t[f.response.msgName])}else{d.find("dd."+U).removeClass(V);c.renderData(i,t[f.response.dataName],o,l,s);z[i].config.isEmpty=t[f.response.dataName].length==0}f.success&&f.success instanceof Function&&f.success(i,a,r,t)},error:function e(t){d.find("dd[lay-value]:not(."+W+")").remove();d.find("dd."+U).addClass(V).text("服务异常");f.error&&f.error instanceof Function&&f.error(i,a,r,t)}})};d.prototype.renderData=function(s,r,e,c,t){var n=this;if(e){var i=function(){var n=[],i=0,o={0:r},l=Y[s]?Y[s]:X;G[s]={};var e=function e(){var r=n[i++]=[],t=o;o={};Q.each(t,function(a,e){Q.each(e,function(e,t){var n={pid:a,name:t[l.keyName],value:t[l.keyVal]};G[s][n.value]=Q.extend(t,n);r.push(n);var i=t[l.keyChildren];if(i&&i.length){o[n.value]=i}})})};do{e()}while(Object.getOwnPropertyNames(o).length);var t=Q("."+m+' dl[xid="'+s+'"]').parents("."+P);var a=['<div class="xm-select-linkage">'];Q.each(n,function(e,t){var i=['<div style="left: '+(c-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(e!=0?"xm-select-linkage-hide":"")+'">'];Q.each(t,function(e,t){var n='<li title="'+t.name+'" pid="'+t.pid+'" xm-value="'+t.value+'"><span>'+t.name+"</span></li>";i.push(n)});i.push("</div>");a=a.concat(i)});a.push('<div style="clear: both; height: 288px;"></div>');a.push("</div>");t.find("dl").html(a.join(""));t.find("."+y).css("display","none");return{v:void 0}}();if((typeof i==="undefined"?"undefined":_typeof(i))==="object")return i.v}var a=Q("."+m+' dl[xid="'+s+'"]').parents("."+P);var o=Y[s]?Y[s]:X;var l=a.find("."+g+" input");r=this.exchangeData(s,r);var d=[];a.find("dl").html(this.renderSelect(s,l.attr("placeholder")||l.attr("back"),r.map(function(e){if(e[o.keySel]){d.push({name:e[o.keyName],value:e[o.keyVal]})}var t=Q.extend({},e,{innerHTML:e[o.keyName],value:e[o.keyVal],sel:e[o.keySel],disabled:e[o.keyDis],type:e.type,name:e[o.keyName]});return t})));var f=a.find("."+x);var u=a.find("dl[xid]");if(t){var p=z[s].values;p.forEach(function(e,t){u.find('dd[lay-value="'+e.value+'"]').addClass(w)});d.forEach(function(e,t){if(n.indexOf(p,e)==-1){n.addLabel(s,f,e);u.find('dd[lay-value="'+e.value+'"]').addClass(w);p.push(e)}})}else{d.forEach(function(e,t){n.addLabel(s,f,e);u.find('dd[lay-value="'+e.value+'"]').addClass(w)});z[s].values=d}this.commonHandler(s,f)};d.prototype.exchangeData=function(e,t){var n=Y[e]?Y[e]:X;var i=n["keyChildren"];var a=n["keyDis"];G[e]={};var r=this.getChildrenList(t,i,a,[],false);return r};d.prototype.getChildrenList=function(e,t,n,i,a){var r=[];for(var o=0;o<e.length;o++){var l=e[o];var s=i.concat([]);s.push(o);l[B]=JSON.stringify(s);l[n]=l[n]||a;r.push(l);var c=l[t];if(c&&K.isArray(c)&&c.length){l["XM_TREE_FOLDER"]=true;var d=s.concat([]);var f=this.getChildrenList(c,t,n,d,l[n]);r=r.concat(f)}else{s=[]}}return r};d.prototype.create=function(e,t,n){if(t&&n){var i=z[e],a=Q('[xid="'+e+'"]'),r=a.find("dd."+W+"."+J),o=null,l=a.find("dd."+p);a.find("dd:not(."+W+"):not(."+p+")").each(function(e,t){if(n==Q(t).find("span").attr("name")){o=t}});if(!o){var s=i.config.create(e,n);if(l[0]){l.attr("lay-value",s);l.find("span").text(n);l.find("span").attr("name",n);l.removeClass(h)}else{r.after(Q(this.createDD(e,{name:n,innerHTML:n,value:s},p+" "+c)))}}}else{Q("[xid="+e+"] dd."+p).remove()}};d.prototype.createDD=function(e,t,n){var i=Q.trim(t.innerHTML);G[e][t.value]=Q(t).is("option")?{name:i,value:t.value}:t;var a=z[e].config.template(i);var r=t[B];r?r=JSON.parse(r):r=[-1];var o=r[0]==-1?"":'tree-id="'+r.join("-")+'" tree-folder="'+!!t["XM_TREE_FOLDER"]+'"';return'<dd lay-value="'+t.value+'" class="'+(t.disabled?E:"")+" "+(n?n:"")+'" '+o+'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?E:"")+'"  style="margin-left: '+(r.length-1)*30+'px">\n\t\t\t\t\t\t<i class="'+l+'"></i>\n\t\t\t\t\t\t<span name="'+i+'">'+a+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"};d.prototype.createQuickBtn=function(e,t){return'<div class="'+q+'" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"};d.prototype.renderBtns=function(e,t,n){var i=this;var a=[];var r=Q('dl[xid="'+e+'"]');a.push('<div class="'+o+'" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">');Q.each(z[e].config.btns,function(e,t){a.push(i.createQuickBtn(t,n))});a.push("</div>");a.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""}));return a.join("")};d.prototype.renderSelect=function(n,e,t){var i=this;G[n]={};var a=[];if(z[n].config.btns.length){setTimeout(function(){var e=Q('dl[xid="'+n+'"]');e.parents("."+P).attr(b,z[n].config.searchType);e.find("."+o).css("max-width",e.prev().width()-54+"px")},10);a.push(['<dd lay-value="" class="'+W+'" style="background-color: #FFF!important;">',this.renderBtns(n,null,"30px"),"</dd>",'<dd lay-value="" class="'+W+" "+J+'" style="background-color: #FFF!important;">','<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="'+M+" "+y+'" placeholder="请搜索"/>',"</dd>"].join(""))}else{a.push('<dd lay-value="" class="'+W+'">'+e+"</dd>")}if(this.isArray(t)){Q(t).each(function(e,t){if(t){if(t.type&&t.type==="optgroup"){a.push("<dt>"+t.name+"</dt>")}else{a.push(i.createDD(n,t))}}})}else{Q(t).find("*").each(function(e,t){if(t.tagName.toLowerCase()=="option"&&e==0&&!t.value){return}if(t.tagName.toLowerCase()==="optgroup"){a.push("<dt>"+t.label+"</dt>")}else{a.push(i.createDD(n,t))}})}a.push('<dt style="display:none;"> </dt>');a.push('<dd class="'+W+" "+U+" "+(a.length===2?V:"")+'">没有选项</dd>');return a.join("")};d.prototype.on=function(){var n=this;this.one();Q(document).on("click",function(e){if(!Q(e.target).parents("."+I)[0]){Q("."+m+" dl ."+h).removeClass(h);Q("."+m+" dl dd."+V).removeClass(V);Q("."+m+" dl dd."+p).remove();Q.each(z,function(e,t){n.clearInput(e);if(!t.values.length){n.changePlaceHolder(Q('div[FS_ID="'+e+'"] .'+x))}})}Q("."+m+" ."+f).each(function(e,t){n.changeShow(Q(t).find("."+I),false)})})};d.prototype.calcLabelLeft=function(e,t,n){var i=this.getPosition(e[0]);i.y=i.x+e[0].clientWidth;var a=e[0].offsetLeft;if(!e.find("span").length){a=0}else if(n){var r=e.find("span:last");r.css("display")=="none"?r=r.prev()[0]:r=r[0];var o=this.getPosition(r);o.y=o.x+r.clientWidth;if(o.y>i.y){a=a-(o.y-i.y)-5}else{a=0}}else{if(t<0){var l=e.find(":last");l.css("display")=="none"?l=l.prev()[0]:l=l[0];var s=this.getPosition(l);s.y=s.x+l.clientWidth;if(s.y>i.y){a-=10}}else{if(a<0){a+=10}if(a>0){a=0}}}e.css("left",a+"px")};d.prototype.one=function(e){var C=this;Q(e?e:document).off("click","."+I).on("click","."+I,function(e){var t=Q(e.target),n=t.is(I)?t:t.parents("."+I),i=n.next(),a=i.attr("xid");Q("dl[xid]").not(i).each(function(e,t){C.clearInput(Q(t).attr("xid"))});Q("dl[xid]").not(i).find("dd."+h).removeClass(h);if(n.hasClass(N)){return false}if(t.is("."+O)||t.is("."+y+"[readonly]")){C.changeShow(n,!n.parents("."+P).hasClass(f));return false}if(n.find("."+y+":not(readonly)")[0]){var r=n.find("."+y),o={x:e.pageX,y:e.pageY},l=C.getPosition(n[0]),s=n.width();while(o.x>l.x){if(Q(document.elementFromPoint(o.x,o.y)).is(r)){r.focus();C.changeShow(n,true);return false}o.x-=50}}if(t.is("."+y)){C.changeShow(n,true);return false}if(t.is('i[fsw="'+v+'"]')){var c=C.getItem(a,t.parent().attr("value")),d=i.find("dd[lay-value='"+c.value+"']");if(d.hasClass(E)){return false}C.handlerLabel(a,d,false,c);return false}C.changeShow(n,!n.parents("."+P).hasClass(f));return false});Q(e?e:document).off("click","dl."+D).on("click","dl."+D,function(e){var t=Q(e.target);if(t.is("."+F)||t.parents("."+F)[0]){t=t.is("li")?t:t.parents("li");var n=t.parents(".xm-select-linkage-group"),i=t.parents("dl").attr("xid");if(!i){return false}n.find(".xm-select-active").removeClass("xm-select-active");t.addClass("xm-select-active");n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var a=n.next(".xm-select-linkage-group");a.find("li").addClass("xm-select-linkage-hide");a.find('li[pid="'+t.attr("xm-value")+'"]').removeClass("xm-select-linkage-hide");if(!a[0]||a.find("li:not(.xm-select-linkage-hide)").length==0){var r=[],o=0,l=!t.hasClass("xm-select-this");if(z[i].config.radio){t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this")}do{r[o++]={name:t.find("span").text(),value:t.attr("xm-value")};t=t.parents(".xm-select-linkage-group").prev().find('li[xm-value="'+t.attr("pid")+'"]')}while(t.length);r.reverse();var s={name:r.map(function(e){return e.name}).join("/"),value:r.map(function(e){return e.value}).join("/")};C.handlerLabel(i,null,l,s)}else{a.removeClass("xm-select-linkage-hide")}return false}if(t.is("dl")){return false}if(t.is("dt")){t.nextUntil("dt").each(function(e,t){t=Q(t);if(t.hasClass(E)||t.hasClass(w)){}else{t.find("i:not(.icon-expand)").click()}});return false}var c=t.is("dd")?t:t.parents("dd");var d=c.parent("dl").attr("xid");if(c.hasClass(E)){return false}if(t.is("i.icon-caidan")){var f=[],u=[];t.parents("dl").find('dd[tree-folder="true"]').each(function(e,t){Q(t).attr("xm-tree-hidn")==undefined?f.push(t):u.push(t)});var p=u.length?u:f;p.forEach(function(e){return e.click()});return false}var h=c.attr("tree-id");if(h){if(t.is("i:not(.icon-expand)")){C.handlerLabel(d,c,!c.hasClass(w));return false}var v=Y[d]||X;var m=v.tree;var y=c.nextAll('dd[tree-id^="'+h+'"]');if(y&&y.length){var g=y[0].clientHeight;g?(C.addTreeHeight(c,g),g=0):(g=c.attr("xm-tree-hidn")||36,c.removeAttr("xm-tree-hidn"),c.find(">i").remove(),y=y.filter(function(e,t){return Q(t).attr("tree-id").split("-").length-1==h.split("-").length}));y.animate({height:g},150);return false}else{if(m.nextClick&&m.nextClick instanceof Function){m.nextClick(d,C.getItem(d,c),function(e){if(!e||!e.length){C.handlerLabel(d,c,!c.hasClass(w))}else{c.attr("tree-folder","true");var n=[];e.forEach(function(e,t){e.innerHTML=e[v.keyName];e[B]=JSON.stringify(h.split("-").concat([t]));n.push(C.createDD(d,e));G[d][e[v.keyVal]]=e});c.after(n.join(""))}});return false}}}if(c.hasClass(W)){var x=t.is("."+q)?t:t.parents("."+q);if(!x[0]){return false}var k=x.attr("method");var b=z[d].config.btns.filter(function(e){return e.name==k})[0];b&&b.click&&b.click instanceof Function&&b.click(d,C);return false}C.handlerLabel(d,c,!c.hasClass(w));return false})};d.prototype.addTreeHeight=function(e,i){var a=this;var t=e.attr("tree-id");var n=e.nextAll('dd[tree-id^="'+t+'"]');if(n.length){e.append('<i class="xm-iconfont icon-expand"></i>');e.attr("xm-tree-hidn",i);n.each(function(e,t){var n=Q(t);a.addTreeHeight(n,i)})}};var G={};d.prototype.getItem=function(e,t){if(t instanceof Q){t=t.attr("lay-value")}else if(typeof t=="string"&&t.indexOf("/")!=-1){return G[e][t]||{name:this.valToName(e,t),value:t}}return G[e][t]};d.prototype.linkageAdd=function(e,t){var n=Q('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var i=t.value.split("/");var a=void 0,r=void 0,o=0;var l=[];do{a=i[o];r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]');r[0]&&l.push(r);o++}while(r.length&&a!=undefined);if(l.length==i.length){Q.each(l,function(e,t){t.addClass("xm-select-this")})}};d.prototype.linkageDel=function(e,t){var n=Q('dl[xid="'+e+'"]');var i=t.value.split("/");var a=void 0,r=void 0,o=i.length-1;do{a=i[o];r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]');if(!r.parent().next().find("li[pid="+a+"].xm-select-this").length){r.removeClass("xm-select-this")}o--}while(r.length&&a!=undefined)};d.prototype.valToName=function(e,t){var i=Q('dl[xid="'+e+'"]');var n=(t+"").split("/");if(!n.length){return null}var a=[];Q.each(n,function(e,t){var n=i.find(".xm-select-linkage-group"+(e+1)+' li[xm-value="'+t+'"] span').text();a.push(n)});return a.length==n.length?a.join("/"):null};d.prototype.commonHandler=function(e,t){if(!t||!t[0]){return}this.checkHideSpan(e,t);this.changePlaceHolder(t);this.retop(t.parents("."+P));this.calcLabelLeft(t,0,true);this.setHidnVal(e,t);t.parents("."+I+" ."+v).attr("title",z[e].values.map(function(e){return e.name}).join(","))};d.prototype.initVal=function(e){var l=this;var t={};if(e){t[e]=z[e]}else{t=z}Q.each(t,function(n,e){var t=e.values,i=Q('dl[xid="'+n+'"]').parent(),a=i.find("."+x),r=i.find("dl");r.find("dd."+w).removeClass(w);var o=t.concat([]);o.concat([]).forEach(function(e,t){l.addLabel(n,a,e);r.find('dd[lay-value="'+e.value+'"]').addClass(w)});if(e.config.radio){o.length&&t.push(o[o.length-1])}l.commonHandler(n,a)})};d.prototype.setHidnVal=function(e,t){if(!t||!t[0]){return}t.parents("."+m).find("."+_).val(z[e].values.map(function(e){return e.value}).join(","))};d.prototype.handlerLabel=function(e,t,n,i,a){var r=Q('[xid="'+e+'"]').prev().find("."+x),o=t&&this.getItem(e,t),l=z[e].values,s=z[e].config.on||R.on[e],c=z[e].config.endOn||R.endOn[e];if(i){o=i}var d=z[e];if(n&&d.config.max&&d.values.length>=d.config.max){var f=R.maxTips[e]||z[e].config.maxTips;f&&f(e,l.concat([]),o,d.config.max);return}if(!a){if(s&&s instanceof Function&&s(e,l.concat([]),o,n,t&&t.hasClass(E))==false){return}}var u=Q('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(w),t.removeClass(p)):u.find(".xm-select-linkage")[0]&&this.linkageAdd(e,o),this.addLabel(e,r,o),l.push(o)):(t&&t[0]?t.removeClass(w):u.find(".xm-select-linkage")[0]&&this.linkageDel(e,o),this.delLabel(e,r,o),this.remove(l,o));if(!r[0])return;if(d.config.radio){this.changeShow(r,false)}r.parents("."+I).prev().removeClass("layui-form-danger");d.config.clearInput&&this.clearInput(e);this.commonHandler(e,r);!a&&c&&c instanceof Function&&c(e,l.concat([]),o,n,t&&t.hasClass(E))};d.prototype.addLabel=function(e,t,n){if(!n)return;var i='fsw="'+v+'"';var a=[Q("<span "+i+' value="'+n.value+'"><font '+i+">"+n.name+"</font></span>"),Q("<i "+i+' class="xm-iconfont icon-close"></i>')],r=a[0],o=a[1];r.append(o);var l=z[e];if(l.config.radio){l.values.length=0;Q('dl[xid="'+e+'"]').find("dd."+w+':not([lay-value="'+n.value+'"])').removeClass(w);t.find("span").remove()}t.find("input").css("width","50px");t.find("input").before(r)};d.prototype.delLabel=function(e,t,n){if(!n)return;t.find('span[value="'+n.value+'"]:first').remove()};d.prototype.checkHideSpan=function(e,t){var n=t.parents("."+v)[0].offsetHeight+5;t.find("span.xm-span-hide").removeClass("xm-span-hide");t.find("span[style]").remove();var i=z[e].config.showCount;t.find("span").each(function(e,t){if(e>=i){Q(t).addClass("xm-span-hide")}});var a=t.find("span:eq("+i+")");a[0]&&a.before(Q('<span style="padding-right: 6px;" fsw="'+v+'"> + '+(t.find("span").length-i)+"</span>"))};d.prototype.retop=function(e){var t=e.find("dl"),n=e.offset().top+e.outerHeight()+5-s.scrollTop(),i=t.outerHeight();var a=e.hasClass("layui-form-selectup")||t.css("top").indexOf("-")!=-1||n+i>s.height()&&n>=i;e=e.find("."+v);var r=z[t.attr("xid")];var o=t.parents(".layui-form-pane")[0]&&t.prev()[0].clientHeight>38?14:10;if(r){if(r.config.direction=="up"){t.css({top:"auto",bottom:"42px"});return}if(r.config.direction=="down"){t.css({top:e[0].offsetTop+e.height()+o+"px",bottom:"auto"});return}}if(a){t.css({top:"auto",bottom:"42px"})}else{t.css({top:e[0].offsetTop+e.height()+o+"px",bottom:"auto"})}};d.prototype.changeShow=function(e,t){Q(".layui-form-selected").removeClass("layui-form-selected");var n=e.parents("."+P),i=n.hasClass(f),a=n.find("dl").attr("xid");Q("."+m+" ."+P).not(n).removeClass(f);if(t){this.retop(n);n.addClass(f);n.find("."+y).focus();if(!n.find("dl dd[lay-value]:not(."+W+")").length){n.find("dl ."+U).addClass(V)}}else{n.removeClass(f);this.clearInput(a);n.find("dl ."+V).removeClass(V);n.find("dl dd."+h).removeClass(h);n.find("dl dd."+p).remove();if(a&&z[a]&&z[a].config.isEmpty){this.triggerSearch(n)}this.changePlaceHolder(n.find("."+x))}if(t!=i){var r=z[a].config.opened||R.opened[a];t&&r&&r instanceof Function&&r(a);var o=z[a].config.closed||R.closed[a];!t&&o&&o instanceof Function&&o(a)}};d.prototype.changePlaceHolder=function(e){var t=e.parents("."+I);t[0]||(t=e.parents("dl").prev());if(!t[0]){return}var n=e.parents("."+m).find("dl[xid]").attr("xid");if(z[n]&&z[n].config.height){}else{var i=t.find("."+v)[0].clientHeight;t.css("height",(i>34?i+4:i)+"px");var a=t.parents("."+m).parent().prev();if(a.is(".layui-form-label")&&t.parents(".layui-form-pane")[0]){i=i>36?i+4:i;t.css("height",i+"px");a.css({height:i+2+"px",lineHeight:i-18+"px"})}}var r=t.find("."+g+" input"),o=!e.find("span:last")[0]&&!t.find("."+y).val();if(o){var l=r.attr("back");r.removeAttr("back");r.attr("placeholder",l)}else{var s=r.attr("placeholder");r.removeAttr("placeholder");r.attr("back",s)}};d.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++){if(e[n].value==t||e[n].value==(t?t.value:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t)){return n}}return-1};d.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.value:t);if(n>-1){e.splice(n,1);return true}return false};d.prototype.selectAll=function(i,a,e){var r=this;var o=Q('[xid="'+i+'"]');if(!o[0]){return}if(o.find(".xm-select-linkage")[0]){return}o.find("dd[lay-value]:not(."+W+"):not(."+w+")"+(e?":not(."+E+")":"")).each(function(e,t){t=Q(t);var n=r.getItem(i,t);r.handlerLabel(i,o.find('dd[lay-value="'+n.value+'"]'),true,n,!a)})};d.prototype.removeAll=function(n,i,a){var r=this;var o=Q('[xid="'+n+'"]');if(!o[0]){return}if(o.find(".xm-select-linkage")[0]){z[n].values.concat([]).forEach(function(e,t){var n=e.value.split("/");var i=void 0,a=void 0,r=0;do{i=n[r++];a=o.find(".xm-select-linkage-group"+r+':not(.xm-select-linkage-hide) li[value="'+i+'"]');a.click()}while(a.length&&i!=undefined)});return}z[n].values.concat([]).forEach(function(e,t){if(a&&o.find('dd[lay-value="'+e.value+'"]').hasClass(E)){}else{r.handlerLabel(n,o.find('dd[lay-value="'+e.value+'"]'),false,e,!i)}})};d.prototype.reverse=function(i,a,e){var r=this;var o=Q('[xid="'+i+'"]');if(!o[0]){return}if(o.find(".xm-select-linkage")[0]){return}o.find("dd[lay-value]:not(."+W+")"+(e?":not(."+E+")":"")).each(function(e,t){t=Q(t);var n=r.getItem(i,t);r.handlerLabel(i,o.find('dd[lay-value="'+n.value+'"]'),!t.hasClass(w),n,!a)})};d.prototype.skin=function(e){var t=["default","primary","normal","warm","danger"];var n=t[Math.floor(Math.random()*t.length)];Q('dl[xid="'+e+'"]').parents("."+m).find("."+P).attr("xm-select-skin",n);this.check(e)&&this.commonHandler(e,Q('dl[xid="'+e+'"]').parents("."+m).find("."+x))};d.prototype.getPosition=function(e){var t=0,n=0;while(e!=null){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{x:t,y:n}};d.prototype.onreset=function(){Q(document).on("click","[type=reset]",function(e){Q(e.target).parents("form").find("."+m+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),i=Q(t),a=void 0,r={};K.removeAll(n);z[n].config.init.forEach(function(e,t){if(e&&(!r[e]||z[n].config.repeat)&&(a=i.find('dd[lay-value="'+e.value+'"]'))[0]){K.handlerLabel(n,a,true);r[e]=1}})})})};d.prototype.bindEvent=function(n,e,i){if(e&&e instanceof Function){i=e;e=null}if(i&&i instanceof Function){if(!e){Q.each(z,function(e,t){z[e]?z[e].config[n]=i:R[n][e]=i})}else{z[e]?(z[e].config[n]=i,delete R[n][e]):R[n][e]=i}}};d.prototype.check=function(e){if(Q('dl[xid="'+e+'"]').length||Q('select[xm-select="'+e+'"]').length){return true}else{delete z[e];return false}};d.prototype.render=function(e,t){K.init(t);K.one(Q('dl[xid="'+e+'"]').parents("."+m));K.initVal(e)};var u=function e(){this.v=t;this.render()};var K=new d;u.prototype.value=function(i,e,t){if(typeof i!="string"){return[]}var a=z[i];if(!K.check(i)){return[]}if(typeof e=="string"||e==undefined){var n=a.values.concat([])||[];if(e=="val"){return n.map(function(e){return e.value})}if(e=="valStr"){return n.map(function(e){return e.value}).join(",")}if(e=="name"){return n.map(function(e){return e.name})}if(e=="nameStr"){return n.map(function(e){return e.name}).join(",")}return n}if(K.isArray(e)){var r=Q('[xid="'+i+'"]'),o={},l=void 0,s=true;if(t==false){s=false}else if(t==true){s=true}else{K.removeAll(i)}if(s){a.values.forEach(function(e,t){o[e.value]=1})}e.forEach(function(e,t){if(e&&(!o[e]||a.config.repeat)){if((l=r.find('dd[lay-value="'+e+'"]'))[0]){K.handlerLabel(i,l,s,null,true);o[e]=1}else{var n=K.valToName(i,e);if(n){K.handlerLabel(i,l,s,K.getItem(i,e),true);o[e]=1}}}})}};u.prototype.on=function(e,t,n){K.bindEvent(n?"endOn":"on",e,t);return this};u.prototype.filter=function(e,t){K.bindEvent("filter",e,t);return this};u.prototype.maxTips=function(e,t){K.bindEvent("maxTips",e,t);return this};u.prototype.opened=function(e,t){K.bindEvent("opened",e,t);return this};u.prototype.closed=function(e,t){K.bindEvent("closed",e,t);return this};u.prototype.config=function(e,n,t){if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=n==true;n=e;e=null}if(n&&(typeof n==="undefined"?"undefined":_typeof(n))=="object"){if(t){n.header||(n.header={});n.header["Content-Type"]="application/json; charset=UTF-8";n.dataType="json"}e?(Y[e]=Q.extend(true,{},Y[e]||X,n),!K.check(e)&&this.render(e),z[e]&&n.direction&&(z[e].config.direction=n.direction),z[e]&&n.clearInput&&(z[e].config.clearInput=true),n.searchUrl&&z[e]&&K.triggerSearch(Q("."+m+' dl[xid="'+e+'"]').parents("."+P),true)):(Q.extend(true,X,n),Q.each(Y,function(e,t){Q.extend(true,t,n)}))}return this};u.prototype.render=function(e,t){var n;if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=e;e=null}var i=t?(n={init:t.init,disabled:t.disabled,max:t.max,isSearch:t.isSearch,searchUrl:t.searchUrl,isCreate:t.isCreate,radio:t.radio,skin:t.skin,direction:t.direction,height:t.height,formname:t.formname,layverify:t.layverify,layverType:t.layverType,showCount:t.showCount,placeholder:t.placeholder,create:t.create,filter:t.filter,maxTips:t.maxTips,on:t.on},_defineProperty(n,"on",t.on),_defineProperty(n,"opened",t.opened),_defineProperty(n,"closed",t.closed),_defineProperty(n,"template",t.template),_defineProperty(n,"clearInput",t.clearInput),n):{};t&&t.searchType!=undefined&&(i.searchType=t.searchType=="dl"?1:0);if(e&&!K.check(e)){return this}if(e){r[e]={};Q.extend(r[e],z[e].config,i)}else{Q.extend(a,i)}(Q("select["+v+'="'+e+'"]')[0]?Q("select["+v+'="'+e+'"]'):Q("select["+v+"]")).each(function(e,t){var n=t.getAttribute(v);K.render(n,t);setTimeout(function(){return K.setHidnVal(n,Q('select[xm-select="'+n+'"] + div.'+m+" ."+x))},10)});return this};u.prototype.disabled=function(e){var t={};e?K.check(e)&&(t[e]=z[e]):t=z;Q.each(t,function(e,t){Q('dl[xid="'+e+'"]').prev().addClass(N)});return this};u.prototype.undisabled=function(e){var t={};e?K.check(e)&&(t[e]=z[e]):t=z;Q.each(t,function(e,t){Q('dl[xid="'+e+'"]').prev().removeClass(N)});return this};u.prototype.data=function(e,t,n){if(!e||!t||!n){return this}!K.check(e)&&this.render(e);this.value(e,[]);this.config(e,n);if(t=="local"){K.renderData(e,n.arr,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}else if(t=="server"){K.ajax(e,n.url,n.keyword,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}return this};u.prototype.btns=function(e,l,s){if(e&&K.isArray(e)){l=e;e=null}if(!l||!K.isArray(l)){return this}var t={};e?K.check(e)&&(t[e]=z[e]):t=z;l=l.map(function(e){if(typeof e=="string"){if(e=="select"){return i[0]}if(e=="remove"){return i[1]}if(e=="reverse"){return i[2]}if(e=="skin"){return i[3]}}return e});Q.each(t,function(e,t){t.config.btns=l;var n=Q('dl[xid="'+e+'"]').find("."+W+":first");if(l.length){var i=s&&s.show&&(s.show=="name"||s.show=="icon")?s.show:"";var a=K.renderBtns(e,i,s&&s.space?s.space:"30px");n.html(a)}else{var r=n.parents("."+P).find("."+g+" input");var o=r.attr("placeholder")||r.attr("back");n.html(o);n.removeAttr("style")}});return this};u.prototype.search=function(e,t){if(e&&K.check(e)){Y[e]=Q.extend(true,{},Y[e]||X,{first:true,searchVal:t});K.triggerSearch(Q('dl[xid="'+e+'"]').parents("."+P),true)}return this};return new u});